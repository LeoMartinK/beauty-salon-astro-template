---
// src/components/atoms/ScrollToTop.astro
---

<button
  id="scroll-to-top"
  aria-label="Volver arriba"
  class="invisible fixed bottom-8 right-8 z-50 translate-y-10 rounded-full bg-pink-500 p-3 text-white opacity-0 shadow-lg shadow-pink-200/50 transition-all duration-500 hover:bg-pink-400"
>
  <svg
    xmlns="http://www.w3.org/2000/svg"
    class="h-6 w-6"
    fill="none"
    viewBox="0 0 24 24"
    stroke="currentColor"
    stroke-width="2"
  >
    <path stroke-linecap="round" stroke-linejoin="round" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
  </svg>
</button>

<script>
  document.addEventListener('astro:page-load', () => {
    const scrollBtn = document.getElementById('scroll-to-top');

    // Función para mostrar/ocultar
    const toggleVisibility = () => {
      if (window.scrollY > 300) {
        scrollBtn?.classList.remove('opacity-0', 'invisible', 'translate-y-10');
        scrollBtn?.classList.add('opacity-100', 'visible', 'translate-y-0');
      } else {
        scrollBtn?.classList.add('opacity-0', 'invisible', 'translate-y-10');
        scrollBtn?.classList.remove('opacity-100', 'visible', 'translate-y-0');
      }
    };

    // 1. Escuchar el scroll
    window.addEventListener('scroll', toggleVisibility, { passive: true });

    // 2. Lógica de Clic
    scrollBtn?.addEventListener('click', () => {
      window.scrollTo({
        top: 0,
        behavior: 'smooth',
      });
    });

    // 3. Ejecutar una vez al inicio para verificar estado actual
    // (Importante al cambiar de página para que se oculte si estamos arriba)
    toggleVisibility();
  });
</script>
